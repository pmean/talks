---
title: "Clinical statistics for non-statisticians: Day one"
author: "Steve Simon"
format: 
  pptx:
    slide-number: true
    embed-resources: true
editor: visual
---

## Introduction

-   Tell us one interesting number about yourself
-   Examples
    -   I have traveled to eight countries outside the United States
        -   (Canada, Italy, China, France, Russia, England, Holland, and Iceland)
    -   I did not learn how to drive until I was 29 years old
    -   My highest chess rating was 1802, but I am not that good any more.

::: notes
Speaker notes

I want to learn a bit about all of you, and I'm going to do this in a statistical way. Tell me three numbers about yourself. These could be something simple, like the number of children you have or something exotic like the height of the highest mountain you have climbed.

Here are three numbers about me.
:::

## Your turn

## A bit more about myself

-   PhD in Statistics in 1982 from the University of Iowa
-   Currently full professor
-   Part-time statistical consultant
-   Funded on 18 research grants
-   Over 100 peer-reviewed publications
-   Website with over 2,000 pages
-   Many invitations to talk at conferences

::: notes
I have a PhD in Statistics from the University of Iowa. I have always had a strong interest in the computational side of Statistics. My dissertation was 150 pages, and 100 of those pages were computer generated graphs.

I am currently a full professor at the University of Missouri-Kansas City in the Department of Biomedical and Health Informatics. I also do statistical consulting on a part-time basis.

I have been a prolific researcher, receiving support from 18 different grants, and writing over 100 peer-reviewed publications.

I started a website in 1998, writing about data analysis, research ethics, and evidence based medicine. I wrote about two or three pages every week and my site now has over 2,000 pages. It shows the value of persistence.

I love to talk about Statistics and have given many presentations at regional, national, and international conferences. This ranges from short 15 minute talks to day long short courses.
:::

## Outline of the three day course

-   Day one: Numerical summaries and data visualization
-   Day two: Hypothesis testing and sampling
-   Day three: Statistical tests to compare treatment to a control and regression models

My goal: help you to become a better consumer of statistics

::: notes
Speaker notes
:::

## Day one topics

-   Numerical summaries
    -   When should you present the mean versus the median
    -   When should you present the range versus standard deviation
    -   How should you display percentages
    -   Why should you round liberally

::: notes
Speaker notes
:::

## Day one topics (continued)

-   Data visualization
    -   How should you display continuous data
    -   Why is the normal bell-shaped curve important
    -   How should you display categorical data
    -   How do you illustrate trends and patterns
    -   What are some common mistakes in the choice of colors

::: notes
Speaker notes
:::

## Counting and proportions

-   Counts are the most common statistic
    -   Counts are error prone
    -   Counts require a solid operational definition
    

::: notes
Speaker notes

Let's start with the simplest statistic of all a simple count. This is probably the most common statistic produced.

But counts can be tricky. The counting process is error prone and requires a solid operational definition.
:::

## Student exercise

Count the number of occurrences of the letter "e".

```{}
A quality control  program is easiest
to implement from the top down. 
Make sure that you understand the 
the commitment of time and money
that is involved. Every workplace is
different, but think about allocating
10% of your time and 10% of the 
time of all your employees to 
quality control.
```

::: notes
Speaker notes

Here's an exercise I want you to do. Just count the number of occurrences of the letter "e". Once you have your answer, type it in the chat box.

[Pause here]

The numbers are different because of two things. First, it is easy to make mistakes. Did anyone notice the repetition of the word "the" at the end of the third line and the beginning of the fourth. It would be easy to miss that and count one less "e".

What did you do with the first e in "Every"?

Did you count the e's in the quotes itself or also on the slide instructions and the slide header?
:::

## Counting sperm

![Image of a haemocytometer](sperm-count.png){#fig-who-2021 fig-align="left"} 

::: notes
Speaker notes

This image is take from the WHO laboratory manual for the examination and processing of human semen, published in 2021. It shows a haemocytometer, an instrument used for counting the number of cells. To get a proper count, you need to include any cells inside the four by four grid of large squares in the middle of this micrograph. But what does "inside" mean? Should you count only those cells entirely inside the four by four grid. Or should you include cells that are partially inside the grid?

One rule is to count cells if the head of the sperm cell touches the top or right side of a square, but not if it touches the bottom or left side of the square. And don't count a sperm cell if only the tail is inside the square.

That's not the only way you can do this, but just make sure that whatever convention you use for deciding "inside" versus "outside" is consistent across your laboratory.
:::

## Tables of counts, using the Titanic data.

![Counts of survival by gender](titanic-counts.png){#fig-counts fig-align="left"}

::: notes
Speaker notes
:::

## Percentages dividing by column totals

![Column percentages](titanic-column-percents.png){#fig-column-percents fig-align="left"}

::: notes
Speaker notes
:::

## Percentages dividing by row totals

![Row percentages](titanic-row-percents.png){#fig-column-percents fig-align="left"}

::: notes
Speaker notes
:::

## Percentages divided by grand total

![Cell percentages](titanic-cell-percents.png){#fig-column-percents fig-align="left"}

::: notes
Speaker notes
:::

## My recommendations

+ Treatment or exposure as rows
+ Outcome as columns
+ Usually report row percentages
  + Female mortality rate: 33%
  + Male mortality rate: 83%
+ But sometimes column percentages 
  + Survivors: 68% female, 32% male

::: notes
Speaker notes
:::

## Some rationale for these choices

:::: {.columns}

::: {.column width="50%"}
My way

```{}
               Survived
               No          Yes
Sex Female     33% (154)   67% (308)
    Male       83% (863)   17% (142)
```
:::

::: {.column width="50%"}
Not my way

```{}
               Sex
               Female      Male
Survived  No   33% (154)   83% (863)
          Yes  67% (308)   17% (142)
```
:::

::::

::: notes
Speaker notes

Now, I believe it is important to think carefully about which is your rows and which is your columns. Here's the layout that I recommend on the left and the layout that I don't recommend on the right. The key comparison is among survival rates, 67% for females and only 17% for males. When you orient my way with the treatment/exposure (Sex) as rows and the outcome (Survived) as the columns, the numbers 67% and 17% are very close to one another. In the alternate layout the numbers you are most interested in comparing are not as close together.

Now this is not an absolute rule. Sometimes I'll switch things up. But about 90% of the time, I find that the layout with the treatment or exposure as the rows and the outcome as the columns, the table just looks better.

:::

## On your own

Calculate row and column percentages for the following tables. Interpret your results.

:::: {.columns}

::: {.column width="50%"}
![Titanic passenger class counts](titanic-passenger-class-counts.png){#fig-titanic-pclass fig-align="left"}
:::

::: {.column width="50%"}
![Titanic child counts](titanic-child-counts.png){#fig-titanic-child fig-align="left"}
:::

::::

::: notes
Speaker notes

Now try to report both column and row percents for one of these two tables. Breakout room #1 work on the passenger class table and breakout room #2 work on the child data.

Put your percentages in a table using a word processing program or text editor so you can share your results with the group.

Be sure to interpret these numbers. Come back together again in about 10 minutes.
:::

## First great controvesy: mean versus median

-   Mean
    -   Add up all the values, divide by the sample size
    -   Example
-   Median
    -   Sort the data, choose the middle value(s)
    -   Example

::: notes
Speaker notes
:::

## Bacteria before and after A/C upgrade

```{r}
suppressMessages(
  suppressWarnings(
    library(glue)))
suppressMessages(
  suppressWarnings(
    library(magrittr)))
suppressMessages(
  suppressWarnings(
    library(tidyverse)))
room <- c(
  121,
  125,
  163,
  218,
  233,
  264,
  324,
  325)
bacteria_0 <- c(
  11.8,
  7.1,
  8.2,
  10.1,
  10.8,
  14,
  14.6,
  14)
  
bacteria_1 <- c(
  10.1,
  3.8,
  7.2,
  10.5,
  8.3,
  12,
  12.1,
  13.7)

```

```         
Room Before  After Change
 121   11.8   10.1   -1.7
 125    7.1    3.8   -3.3
 163    8.2    7.2   -1.0
 218   10.1   10.5    0.4
 233   10.8    8.3   -2.5
 264   14     12     -2.0
 324   14.6   12.1   -2.5
 325   14     13.7   -0.3  
```

::: notes
Speaker notes
:::

## Calculation of the mean and median

-   Mean
    -   Add up all the values
    -   Divide by the sample size
-   Median
    -   Sort the data
    -   Select the middle value
        -   go halfway between the two middle values

::: notes
Speaker notes

The calculation of the mean and median are fairly simple. For the mean, you just add up all the values and divide by the sample size.

For the median, you sort the data and choose the middle value. If the sample size is odd, there will be one middle value. If it is even, there will be two middle values. Just split the difference and go halfway between the two middle values.
:::

## Before remediation mean

```{r}
adds_0 <- paste0(bacteria_0, collapse=" + ") 
sum_0 <- sum(bacteria_0)
mean_0 <- mean(bacteria_0)
```

```         
`r adds_0` = `r sum_0`

`r sum_0` / 8 = `r mean_0`

Round to `r round(mean_0, 1)`
```

::: notes
Speaker notes

Here's the data for bacterial counts before remediation. If you add the eight values up, you get `r sum_0`. Divide this by eight to get `r mean_0`. Always round liberally when you are talking about the mean.
:::

## After remediation mean

```{r}
adds_1 <- paste0(bacteria_1, collapse=" + ") 
sum_1 <- sum(bacteria_1)
mean_1 <- mean(bacteria_1)
```

```         
`r adds_1` = `r sum_1`

`r sum_1` / 8 = `r mean_1`

Round to `r round(mean_1, 1)`
```

::: notes
Speaker notes

Here are the same calculations for the bacterial counts after remediation.
:::

## Before remediation median (1/4)

```{r}
space <- function(x) {
  x1 <- rep("", 15)
  x1[2*(1:8)-1] <- x
  return(x1)
}

sq <- function(x) {
  paste0(x, collapse="\n")
}

step1 <- function(x) {
  y <- sprintf("%4.1f", x)
  room %>%
    paste(y, sep="  ") %>%
    space
}
```

```         
`r sq(step1(bacteria_0))`
```

::: notes
Speaker notes

Here is the data for bacteria counts before remediation. Notice that the data is arranged by room number.
:::

## Before remediation median (2/4)

```{r}
step2 <- function(x) {
  o <- order(x)
  y <- sprintf("%4.1f", x[o])
  room[o] %>%
    paste(y, sep="  ") %>%
    space
}
```

```         
`r sq(step2(bacteria_0))`
```

::: notes
Speaker notes

The first thing you do is sort the data from the lowest bacteria count to the highest bacteria count.
:::

## Before remediation median (3/4)

```{r}
step3 <- function(x) {
  o <- order(x)
  y <- rep("", 8)
  y[4:5] <- x[o][4:5]
  step2(x) %>%
    paste(space(y), sep="  ")
}
```

```         
`r sq(step3(bacteria_0))`
```

::: notes
Speaker notes

Then pick out the middle value. If you have an even number of data points, there will be two middle values.
:::

## Before remediation median (4/4)

```{r}
step4 <- function(x) {
  o <- order(x)
  x1 <- x[o]
  x4 <- step3(x)
  blanks <- paste0(rep(" ", 18), collapse="")
  x4[8] <- glue(
    "{blanks}",
    "({x1[4]} + {x1[5]}) / 2",
    " = {(x1[4]+x1[5])/2}")
  return(x4)
}
```

```         
`r sq(step4(bacteria_0)) `
```

::: notes
Speaker notes

If there are two middle values, just average them.
:::

## After remediation median (1/4)

```         
`r sq(step1(bacteria_1))`
```

::: notes
Speaker notes

Here is the data for bacteria counts after remediation.
:::

## After remediation median (2/4)

```         
`r sq(step2(bacteria_1))`
```

::: notes
Speaker notes

Just like before, you sort the data.
:::

## After remediation median (3/4)

```         
`r sq(step3(bacteria_1))`
```

::: notes
Speaker notes

Then pick out the middle value. Here again, there are two middle values.
:::

## After remediation median (4/4)

```         
`r sq(step4(bacteria_1)) `
```

::: notes
Speaker notes

Just average the two middle values.
:::

## Choosing between the mean and median

-   When do you use the mean?
    -   When totals are important
-   When do you use the median
    -   When outliers/skewness might distort your conclusions
-   Often, either is fine

::: notes
Speaker notes
:::

## Criticisms of the mean and median

-   Are you combining apples and onions?
-   Are you ignoring minorities?

::: notes
There's a wonderful cartoon by Dana Fradon that appeared in The New Yorker in 1976. She shows a road going into town and the sign by the side of the road reads "Hillsdale, Founded 1802, Altitude 600, Population 3,700. Total 6,122." You can't add these things together.

It's similar for means. There was a dataset showing housing prices for homes in Boston and none of the analyses seemed to make sense. The problem in Boston is that a small number of the houses had prices that were out of sync with their other homes. These were historical houses, such as Paul Revere's house.

When you are averaging numbers, maybe it's okay to have a few oranges in with the apples. A mix of apples and oranges is just fruit salad. You shouldn't have a problem with that.

When it becomes a problem is when the data are so diverse that it becomes a mix of apples and onions. There are lots of great recipes that mix apples and oranges, but none that mix apples and onions.

The other problem is that an average may be a reasonable number to represent the majority of patients in your sample, but it may masks some important trends that appear in a minority.

This is a big problem in a larger context than just the mean or median. There are some very fancy high tech predition models that work very well for most people and the statistics like the mean and median back this up quite nicely. But the prediction models perform terribly for minority groups.
:::

## Use of the mean for ordinal data

## Gould 1985

![Gould 1985](gould-1985.png){#fig-gould-1985 fig-align="left"}

::: notes
Speaker notes

Stephen Jay Gould was a famous Evolutionary Biologist. He was a prolific writer with 20 books and 300 essays. Much of his writing was for academic researchers, but just as much was for the general public.

One of his most famous essays was "The Median Isn't the Message". The title is a take-off of a quote by Marshall McLuhan, "The medium is the message" which itself has an interesting history that you should investigate on your own.

The Gould essay was written in 1985 for Discover Magazine. It has been reprinted many times, and you can easily find the full text with a simple Google search.

The image shown here is taken from phoenix5.org, an informational site for patients with prostate cancer.
:::

## Bridge 2001, PMID: 11405531

![Bridge and McKenzie 2001](bridge-2001.png){#fig-bridge-2001 fig-align="left"}

::: notes
Speaker notes
:::

## Bridge 2001, PMID: 11405531 (continued)

The measurement of airway resistance by the interrupter technique (Rint) needs standardization. Should measurements be made be during the expiratory or inspiratory phase of tidal breathing? **In reported studies, the measurement of Rint has been calculated as the median or mean of a small number of values, is there an important difference?**

::: notes
Speaker notes
:::

## Bridge 2001, PMID: 11405531 (continued)

In the present data the mean of a set of values contributing to a measurement was not significantly different from the median. **However, the use of the median has been recommended since it is less affected by possible outlying values such as might be included by fully automated equipment.**

::: notes
Speaker notes
:::

## Chen 2019, PMID: 31806195

![Chen et al 2019](chen-2019.png){#fig-chen-2019 fig-align="left"}

::: notes
Speaker notes
:::

## Chen 2019, PMID: 31806195 (continued)

Background: The prices of newly approved cancer drugs have risen over the past decades. **A key policy question is whether the clinical gains offered by these drugs in treating specific cancer indications justify the price increases.**

::: notes
Speaker notes
:::

## Chen 2019, PMID: 31806195 (continued)

Results: We found that between 1995 and 2012, price increases outstripped median survival gains, a finding consistent with previous literature. **Nevertheless, price per mean life-year gained increased at a considerably slower rate, suggesting that new drugs have been more effective in achieving longer-term survival.** Between 2013 and 2017, price increases reflected equally large gains in median and mean survival, resulting in a flat profile for benefit-adjusted launch prices in recent years.

::: notes
Speaker notes
:::

## Gould 2006

![Gould 2006](gould-2006.jpg){#fig-gould-2006 fig-align="left"}

::: notes
Speaker notes

This cover is taken from the Amazon website.
:::

## Best 2012

![Best 2012](best-2012.jpg){#fig-best-2012 fig-align="left"}

::: notes
Speaker notes

First edition, 2001. Second edition, 2012.

Image taken from Amazon website.
:::

## O'Neil 2016

![O'Neil 2016](oneil-2016.jpg){#fig-oneil-2016 fig-align="left"}

::: notes
Speaker notes

First edition, 2016.

Image taken from Amazon website.
:::

## How companies learn your secrets

https://www.nytimes.com/2012/02/19/magazine/shopping-habits.html

## Machine Bias

https://www.propublica.org/article/machine-bias-risk-assessments-in-criminal-sentencing

## Bias in Algorithms

https://fra.europa.eu/sites/default/files/fra_uploads/fra-2022-bias-in-algorithms_en.pdf
